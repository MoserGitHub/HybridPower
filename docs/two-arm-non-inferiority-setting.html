<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Two-arm non-inferiority setting | Frequentist, Bayesian and hybrid approaches for sample size and power calculations</title>
  <meta name="description" content="Chapter 2 Two-arm non-inferiority setting | Frequentist, Bayesian and hybrid approaches for sample size and power calculations" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Two-arm non-inferiority setting | Frequentist, Bayesian and hybrid approaches for sample size and power calculations" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Two-arm non-inferiority setting | Frequentist, Bayesian and hybrid approaches for sample size and power calculations" />
  
  
  

<meta name="author" content="André Moser, CTU Bern, University of Bern" />


<meta name="date" content="2023-04-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="two-arm-non-inferiority-setting.html"><a href="two-arm-non-inferiority-setting.html"><i class="fa fa-check"></i><b>2</b> Two-arm non-inferiority setting</a>
<ul>
<li class="chapter" data-level="2.1" data-path="two-arm-non-inferiority-setting.html"><a href="two-arm-non-inferiority-setting.html#binomial-outcome"><i class="fa fa-check"></i><b>2.1</b> Binomial outcome</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="two-arm-non-inferiority-setting.html"><a href="two-arm-non-inferiority-setting.html#frequentist-sample-size"><i class="fa fa-check"></i><b>2.1.1</b> Frequentist sample size</a></li>
<li class="chapter" data-level="2.1.2" data-path="two-arm-non-inferiority-setting.html"><a href="two-arm-non-inferiority-setting.html#frequentist-sample-size-calculation-in-r"><i class="fa fa-check"></i><b>2.1.2</b> Frequentist sample size: Calculation in R</a></li>
<li class="chapter" data-level="2.1.3" data-path="two-arm-non-inferiority-setting.html"><a href="two-arm-non-inferiority-setting.html#hybrid-approach-prior-on-treatment-effect"><i class="fa fa-check"></i><b>2.1.3</b> Hybrid approach: Prior on treatment effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Frequentist, Bayesian and hybrid approaches for sample size and power calculations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-arm-non-inferiority-setting" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Two-arm non-inferiority setting<a href="two-arm-non-inferiority-setting.html#two-arm-non-inferiority-setting" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section we consider a non-inferiority clinical trial setting with a null hypothesis <span class="math inline">\(H_0: \delta &gt; \delta^*\)</span> and alternative hypothesis <span class="math inline">\(H_a: \delta \leq \delta^*\)</span>, where <span class="math inline">\(\delta^*&gt;0\)</span> is a fixed non-inferiority margin and a treatment effect <span class="math inline">\(\delta\)</span>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div id="binomial-outcome" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Binomial outcome<a href="two-arm-non-inferiority-setting.html#binomial-outcome" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here <span class="math inline">\(\delta=p_1-p_0\)</span>, where <span class="math inline">\(p_i\)</span>, <span class="math inline">\(i\in \{0,1\}\)</span>, are event probabilities for two groups.</p>
<hr />
<p><strong>Working example</strong></p>
<p>We use the SAFE-SSPE as a working example <span class="citation">[<a href="#ref-Baumgartner2020" role="doc-biblioref">3</a>]</span>.</p>
<p>For example, <span class="math inline">\(H_0\)</span> is ‘clinical surveillance is inferior to an active treatment’ versus <span class="math inline">\(H_a\)</span> ‘clinical surveillance is non-inferior to an active treatment’. The primary outcome is a risk difference with an non-inferiority margin of 3.5%.</p>
<hr />
<div id="frequentist-sample-size" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Frequentist sample size<a href="two-arm-non-inferiority-setting.html#frequentist-sample-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let <span class="math inline">\(Y_{i,k} \sim^{iid} Bernoulli(p_i)\)</span>, <span class="math inline">\(k=1,\dots,n_i\)</span>, <span class="math inline">\(i\in \{0,1\}\)</span>. Let <span class="math inline">\(\overline p_i=\frac{1}{n_i}\sum_{k\leq n_i} Y_{i,k}\)</span>, <span class="math inline">\(i\in {0,1}\)</span>, and thus the risk difference <span class="math inline">\(D=\overline p_1-\overline p_0\)</span> is Gaussian distributed with <span class="math inline">\(D \sim N\left(\delta, \frac{\sigma_1^2}{n_1}+\frac{\sigma_0^2}{n_0}\right)\)</span>, where <span class="math inline">\(\sigma_i^2=p_i(1-p_i)\)</span>, <span class="math inline">\(i\in \{0,1\}\)</span>.</p>
<p>We are interested whether the upper <span class="math inline">\((1-\alpha)\%\)</span>-confidence limit is smaller than the non-inferiority margin, that is,
<span class="math display">\[
D+z_{1-\alpha}\sqrt{\frac{n_0\sigma_1^2+n_1\sigma_0^2}{n_1n_0}}\leq \delta^*,
\]</span>
where <span class="math inline">\(z_{1-\alpha}=\Phi^{-1}(1-\alpha)\)</span> with <span class="math inline">\(\Phi^{-1}\)</span>, the quantile function of the standard Gaussian distribution function.</p>
<p>Because
<span class="math display">\[
D\leq -z_{1-\alpha}\sqrt{\frac{n_0\sigma_1^2+n_1\sigma_0^2}{n_1n_0}}+\delta^*
\]</span>
we have that, for <span class="math inline">\(\Phi\)</span> being the probability distribution function of the standard Gaussian distribution,
<span class="math display">\[
P(S^{F}|\delta)=P_{\delta}(Z\leq - z_{1-\alpha})= \Phi\left(-z_{1-\alpha}-\sqrt{\frac{n_1n_0}{n_0\sigma_1^2+n_1\sigma_0^2}}(\delta-\delta^*)\right),
\]</span>
since under certain regularity conditions,
<span class="math display">\[
Z=\sqrt{\frac{n_1n_0}{n_0\sigma_1^2+n_1\sigma_0^2}}(D-\delta) \rightarrow^{\min\{n1,n_0\} \rightarrow \infty} N(0,1).
\]</span>
For an alternative point difference <span class="math inline">\(\delta_A\)</span> we have that <span class="math inline">\(P_{\delta_A}(Z\leq - z_{1-\alpha})=1-\beta\)</span>, which is known as the frequentist power (or the <strong>probability of rejection given <span class="math inline">\(\delta_A\)</span></strong>). From that we have that</p>
<p><span class="math display">\[
-z_{1-\alpha}-\sqrt{\frac{n_1n_0}{n_0\sigma_1^2+n_1\sigma_0^2}}(\delta-\delta^*)=\Phi^{-1}(1-\beta)=z_{1-\beta}
\]</span>
and so the frequentist sample size can then be derived as
<span class="math display">\[
\frac{(z_{1-\beta}+z_{1-\alpha})^2}{(\delta-\delta^*)^2}=\frac{an_0^2}{n_0\sigma_1^2+an_0\sigma_0^2},
\]</span>
where <span class="math inline">\(a=n_1/n_0\)</span> is an allocation ratio, such that
<span class="math display">\[
n_0=(z_{1-\beta}+z_{1-\alpha})^2\frac{\sigma_1^2+a\sigma_0^2}{a(\delta-\delta^*)^2}, \quad n_1=an_0.
\]</span></p>
<p><span class="math inline">\(\delta_A\)</span> and <span class="math inline">\(\delta^*\)</span> are assumed as fixed constants in a frequentist approach. Their choices are of high importance, because all trial conclusions are based on those choices and affect the sample size calculation. The plot below shows how the sample size increase as <span class="math inline">\(\delta^* \rightarrow \delta\)</span>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="frequentist-sample-size-calculation-in-r" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Frequentist sample size: Calculation in R<a href="two-arm-non-inferiority-setting.html#frequentist-sample-size-calculation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following <span class="math inline">\(R\)</span> function can be used to calculate the required sample size.</p>
<ul>
<li><span class="math inline">\(p_1=0.01\)</span>, <span class="math inline">\(p_0=0.01\)</span>, <span class="math inline">\(\delta^*=0.035\)</span>, <span class="math inline">\(1-\beta=0.8\)</span>, <span class="math inline">\(\alpha=0.05\)</span>, <span class="math inline">\(a=1/1\)</span></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="two-arm-non-inferiority-setting.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span>
<span id="cb1-2"><a href="two-arm-non-inferiority-setting.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="two-arm-non-inferiority-setting.html#cb1-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb1-4"><a href="two-arm-non-inferiority-setting.html#cb1-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb1-5"><a href="two-arm-non-inferiority-setting.html#cb1-5" aria-hidden="true" tabindex="-1"></a>p_0 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb1-6"><a href="two-arm-non-inferiority-setting.html#cb1-6" aria-hidden="true" tabindex="-1"></a>p_1 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb1-7"><a href="two-arm-non-inferiority-setting.html#cb1-7" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> p_1<span class="sc">-</span>p_0</span>
<span id="cb1-8"><a href="two-arm-non-inferiority-setting.html#cb1-8" aria-hidden="true" tabindex="-1"></a>delta_star <span class="ot">&lt;-</span> <span class="fl">0.035</span></span>
<span id="cb1-9"><a href="two-arm-non-inferiority-setting.html#cb1-9" aria-hidden="true" tabindex="-1"></a>sd_0 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_0))</span>
<span id="cb1-10"><a href="two-arm-non-inferiority-setting.html#cb1-10" aria-hidden="true" tabindex="-1"></a>sd_1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_1))</span>
<span id="cb1-11"><a href="two-arm-non-inferiority-setting.html#cb1-11" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">1</span></span>
<span id="cb1-12"><a href="two-arm-non-inferiority-setting.html#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="two-arm-non-inferiority-setting.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.ssninfb</span>(<span class="at">treat=</span>p_1, <span class="at">control=</span>p_0, <span class="at">delta=</span>delta_star, <span class="at">power=</span><span class="dv">1</span><span class="sc">-</span>beta, <span class="at">r=</span>a, <span class="at">alpha=</span>alpha, <span class="at">n=</span><span class="cn">NA</span>)</span></code></pre></div>
<pre><code>## $n.total
## [1] 200
## 
## $n.treat
## [1] 100
## 
## $n.control
## [1] 100
## 
## $delta
## [1] 0.035
## 
## $power
## [1] 0.8</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="two-arm-non-inferiority-setting.html#cb3-1" aria-hidden="true" tabindex="-1"></a>n_0 <span class="ot">&lt;-</span> ((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>((sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>a<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(a<span class="sc">*</span>(delta<span class="sc">-</span>delta_star)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb3-2"><a href="two-arm-non-inferiority-setting.html#cb3-2" aria-hidden="true" tabindex="-1"></a>n_0</span></code></pre></div>
<pre><code>## [1] 99.93031</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="two-arm-non-inferiority-setting.html#cb5-1" aria-hidden="true" tabindex="-1"></a>n_1 <span class="ot">&lt;-</span> n_0<span class="sc">*</span>a</span>
<span id="cb5-2"><a href="two-arm-non-inferiority-setting.html#cb5-2" aria-hidden="true" tabindex="-1"></a>n_1</span></code></pre></div>
<pre><code>## [1] 99.93031</code></pre>
</div>
<div id="hybrid-approach-prior-on-treatment-effect" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Hybrid approach: Prior on treatment effect<a href="two-arm-non-inferiority-setting.html#hybrid-approach-prior-on-treatment-effect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that the true treatment effect <span class="math inline">\(\delta\)</span> is a realization from a random variable <span class="math inline">\(\Delta\)</span> such that <span class="math inline">\(\Delta \sim p(\delta)\)</span>. In this subsection we assume that the prior comes from a Gaussian distribution function so that <span class="math inline">\(\Delta \sim N\left(d, \frac{\sigma_1^2+\sigma_0^2}{m}\right)\)</span>. This prior can be thought as a realisation from a ‘prior sample’ of size <span class="math inline">\(m\)</span>.</p>
<p>In the following we use the following priors:</p>
<ul>
<li><strong>Enthusiastic prior</strong> (favors non-inferiority): <span class="math inline">\(d=0\)</span>, <span class="math inline">\(m=6.6\)</span>, <span class="math inline">\(P(\Delta&gt;\delta^*)=0.05\)</span>. This prior is centered on the treatment effect such that there is a low probability (here 5%) of inferiority.</li>
<li><strong>Skeptical prior</strong> (favors inferiority): <span class="math inline">\(d=\delta^*\)</span>, <span class="math inline">\(m=6.6\)</span>, <span class="math inline">\(P(\Delta&gt;0)=0.05\)</span>. This prior is centered on the non-inferiority margin such that there is a low probability (here 5%) of superiority.</li>
<li><strong>Informative prior</strong> (clinical expert knowledge): <span class="math inline">\(d=0\)</span> with <span class="math inline">\(m=25\)</span>.</li>
<li><strong>Noninformative prior</strong>: <span class="math inline">\(d=0\)</span> with <span class="math inline">\(m=0.5\)</span>.</li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Let
<span class="math display">\[
AP:=\int_{\Delta} P(S^{F}|\delta)p(\delta)d\delta,
\]</span></p>
<p>be the ‘average power’ <span class="citation">[<a href="#ref-Grieve2022" role="doc-biblioref">4</a>]</span> (other terminologies which are often used for the same estimator: assurance <span class="citation">[<a href="#ref-OHagan2005" role="doc-biblioref">5</a>]</span>, probability of success <span class="citation">[<a href="#ref-Kunzmann2022" role="doc-biblioref">1</a>]</span>, <span class="citation">[<a href="#ref-Spiegelhalter2003" role="doc-biblioref">2</a>]</span>). Remember that in an hybrid approach we are interested in trial conclusions from a frequentist point of view, thus we are interested in</p>
<p><span class="math display">\[
D\leq -z_{1-\alpha}\sqrt{\frac{n_0\sigma_1^2+n_1\sigma_0^2}{n_1n_0}}+\delta^*.
\]</span>
By using a design prior we want to take into account the uncertainty of the treatment effect. The predictive distribution from a risk difference from future observations, say <span class="math inline">\(\tilde D\sim f(\tilde\delta)\)</span>, includes this uncertainty. For the Gaussian case, the predictive distribution of <span class="math inline">\(\tilde D\)</span> is distributed as <span class="math inline">\(\tilde D \sim N\left(d, \underbrace{\frac{\sigma_1^2}{n_1}+\frac{\sigma_0^2}{n_0}+\frac{\sigma_1^2}{m}+\frac{\sigma_0^2}{m}}_{\tilde\sigma^2}\right)\)</span>, see for example <span class="citation">[<a href="#ref-Spiegelhalter2003" role="doc-biblioref">2</a>]</span>. Let in the following <span class="math inline">\(c_i=\frac{m+n_i}{m}\)</span>, then <span class="math inline">\(\tilde\sigma^2=\frac{\sigma_1^2c_1}{n_1}+\frac{\sigma_0^2c_0}{n_0}\)</span>.</p>
<p>Suppose now that <span class="math inline">\(D\)</span> has a predictive distribution as described above, then
<span class="math display">\[
AP=\int_{-\infty}^{-z_{1-\alpha}\sqrt{\frac{n_0\sigma_1^2+n_1\sigma_0^2}{n_1n_0}}+\delta^*}f(\tilde\delta)d\tilde\delta= \Phi\left(-z_{1-\alpha}\sqrt{\frac{n_0\sigma_1^2+n_1\sigma_0^2}{n_0\sigma_1^2c_1+n_1\sigma_0^2c_0}}-\sqrt{\frac{n_1n_0}{n_0\sigma_1^2c_1+n_1\sigma_0^2c_0}}(d-\delta^*)\right),
\]</span>
see for example <span class="citation">[<a href="#ref-Grieve2022" role="doc-biblioref">4</a>]</span>. Note that as <span class="math inline">\(m \rightarrow \infty\)</span>, then <span class="math inline">\(c_i \rightarrow 1\)</span>, <span class="math inline">\(i\in {0,1}\)</span>, and <span class="math inline">\(AP \rightarrow \Phi\left(-z_{1-\alpha}-\sqrt{\frac{n_1n_0}{n_0\sigma_1^2+n_1\sigma_0^2}}(d-\delta^*)\right)\)</span>, that is, the frequentist power at <span class="math inline">\(d\)</span>.</p>
<hr />
<p><strong>Working example (continued) </strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="two-arm-non-inferiority-setting.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enthusiastic prior</span></span>
<span id="cb7-2"><a href="two-arm-non-inferiority-setting.html#cb7-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">6.6</span></span>
<span id="cb7-3"><a href="two-arm-non-inferiority-setting.html#cb7-3" aria-hidden="true" tabindex="-1"></a>c_1 <span class="ot">&lt;-</span> (m<span class="sc">+</span>n_1)<span class="sc">/</span>m</span>
<span id="cb7-4"><a href="two-arm-non-inferiority-setting.html#cb7-4" aria-hidden="true" tabindex="-1"></a>c_0 <span class="ot">&lt;-</span> (m<span class="sc">+</span>n_0)<span class="sc">/</span>m</span>
<span id="cb7-5"><a href="two-arm-non-inferiority-setting.html#cb7-5" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-6"><a href="two-arm-non-inferiority-setting.html#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="two-arm-non-inferiority-setting.html#cb7-7" aria-hidden="true" tabindex="-1"></a>AP <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">*</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_1<span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_0)<span class="sc">-</span>(<span class="fu">sqrt</span>(n_0<span class="sc">*</span>n_1)<span class="sc">/</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_1<span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_0))<span class="sc">*</span>(prior_mean<span class="sc">-</span>delta_star))</span>
<span id="cb7-8"><a href="two-arm-non-inferiority-setting.html#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="two-arm-non-inferiority-setting.html#cb7-9" aria-hidden="true" tabindex="-1"></a>data_output <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type=</span><span class="st">&quot;Enthusiastic&quot;</span>, n_0, n_1, <span class="at">AP=</span><span class="fu">round</span>(AP,<span class="dv">2</span>))</span>
<span id="cb7-10"><a href="two-arm-non-inferiority-setting.html#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="two-arm-non-inferiority-setting.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Skeptical prior</span></span>
<span id="cb7-12"><a href="two-arm-non-inferiority-setting.html#cb7-12" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">6.6</span></span>
<span id="cb7-13"><a href="two-arm-non-inferiority-setting.html#cb7-13" aria-hidden="true" tabindex="-1"></a>c_1 <span class="ot">&lt;-</span> (m<span class="sc">+</span>n_1)<span class="sc">/</span>m</span>
<span id="cb7-14"><a href="two-arm-non-inferiority-setting.html#cb7-14" aria-hidden="true" tabindex="-1"></a>c_0 <span class="ot">&lt;-</span> (m<span class="sc">+</span>n_0)<span class="sc">/</span>m</span>
<span id="cb7-15"><a href="two-arm-non-inferiority-setting.html#cb7-15" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> delta_star</span>
<span id="cb7-16"><a href="two-arm-non-inferiority-setting.html#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="two-arm-non-inferiority-setting.html#cb7-17" aria-hidden="true" tabindex="-1"></a>AP <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">*</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_1<span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_0)<span class="sc">-</span>(<span class="fu">sqrt</span>(n_0<span class="sc">*</span>n_1)<span class="sc">/</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_1<span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_0))<span class="sc">*</span>(prior_mean<span class="sc">-</span>delta_star))</span>
<span id="cb7-18"><a href="two-arm-non-inferiority-setting.html#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="two-arm-non-inferiority-setting.html#cb7-19" aria-hidden="true" tabindex="-1"></a>data_output <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_output, <span class="fu">data.frame</span>(<span class="at">type=</span><span class="st">&quot;Skeptical&quot;</span>, n_0, n_1, <span class="at">AP=</span><span class="fu">round</span>(AP,<span class="dv">2</span>)))</span>
<span id="cb7-20"><a href="two-arm-non-inferiority-setting.html#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="two-arm-non-inferiority-setting.html#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Informative prior</span></span>
<span id="cb7-22"><a href="two-arm-non-inferiority-setting.html#cb7-22" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb7-23"><a href="two-arm-non-inferiority-setting.html#cb7-23" aria-hidden="true" tabindex="-1"></a>c_1 <span class="ot">&lt;-</span> (m<span class="sc">+</span>n_1)<span class="sc">/</span>m</span>
<span id="cb7-24"><a href="two-arm-non-inferiority-setting.html#cb7-24" aria-hidden="true" tabindex="-1"></a>c_0 <span class="ot">&lt;-</span> (m<span class="sc">+</span>n_0)<span class="sc">/</span>m</span>
<span id="cb7-25"><a href="two-arm-non-inferiority-setting.html#cb7-25" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-26"><a href="two-arm-non-inferiority-setting.html#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="two-arm-non-inferiority-setting.html#cb7-27" aria-hidden="true" tabindex="-1"></a>AP <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">*</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_1<span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_0)<span class="sc">-</span>(<span class="fu">sqrt</span>(n_0<span class="sc">*</span>n_1)<span class="sc">/</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_1<span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_0))<span class="sc">*</span>(prior_mean<span class="sc">-</span>delta_star))</span>
<span id="cb7-28"><a href="two-arm-non-inferiority-setting.html#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="two-arm-non-inferiority-setting.html#cb7-29" aria-hidden="true" tabindex="-1"></a>data_output <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_output, <span class="fu">data.frame</span>(<span class="at">type=</span><span class="st">&quot;Informative&quot;</span>, n_0, n_1, <span class="at">AP=</span><span class="fu">round</span>(AP,<span class="dv">2</span>)))</span>
<span id="cb7-30"><a href="two-arm-non-inferiority-setting.html#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="two-arm-non-inferiority-setting.html#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Noninformative prior</span></span>
<span id="cb7-32"><a href="two-arm-non-inferiority-setting.html#cb7-32" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb7-33"><a href="two-arm-non-inferiority-setting.html#cb7-33" aria-hidden="true" tabindex="-1"></a>c_1 <span class="ot">&lt;-</span> (m<span class="sc">+</span>n_1)<span class="sc">/</span>m</span>
<span id="cb7-34"><a href="two-arm-non-inferiority-setting.html#cb7-34" aria-hidden="true" tabindex="-1"></a>c_0 <span class="ot">&lt;-</span> (m<span class="sc">+</span>n_0)<span class="sc">/</span>m</span>
<span id="cb7-35"><a href="two-arm-non-inferiority-setting.html#cb7-35" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-36"><a href="two-arm-non-inferiority-setting.html#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="two-arm-non-inferiority-setting.html#cb7-37" aria-hidden="true" tabindex="-1"></a>AP <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">*</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_1<span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_0)<span class="sc">-</span>(<span class="fu">sqrt</span>(n_0<span class="sc">*</span>n_1)<span class="sc">/</span><span class="fu">sqrt</span>(n_0<span class="sc">*</span>sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_1<span class="sc">+</span>n_1<span class="sc">*</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>c_0))<span class="sc">*</span>(prior_mean<span class="sc">-</span>delta_star))</span>
<span id="cb7-38"><a href="two-arm-non-inferiority-setting.html#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="two-arm-non-inferiority-setting.html#cb7-39" aria-hidden="true" tabindex="-1"></a>data_output <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_output, <span class="fu">data.frame</span>(<span class="at">type=</span><span class="st">&quot;Noninformative&quot;</span>, n_0, n_1, <span class="at">AP=</span><span class="fu">round</span>(AP,<span class="dv">2</span>)))</span>
<span id="cb7-40"><a href="two-arm-non-inferiority-setting.html#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="two-arm-non-inferiority-setting.html#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(data_output <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(type))</span></code></pre></div>
<pre><code>##             type      n_0      n_1   AP
## 1   Enthusiastic 99.93031 99.93031 0.58
## 2    Informative 99.93031 99.93031 0.65
## 3 Noninformative 99.93031 99.93031 0.52
## 4      Skeptical 99.93031 99.93031 0.34</code></pre>
<hr />
<p>Rufibach et al. give a closed a formula for the distribution of <span class="math inline">\(RPR:=P_{\Delta}(Z\leq - z_{1-\alpha})\)</span>, where <span class="math inline">\(\Delta \sim N(d,\tilde\sigma^2/n_0)\)</span>, and discuss the shape under different prior choices <span class="citation">[<a href="#ref-Rufibach2016" role="doc-biblioref">6</a>]</span>. In the following we use the wording ’random probability to reject` (RPR) similar to <span class="citation">[<a href="#ref-Kunzmann2022" role="doc-biblioref">1</a>]</span>.</p>
<hr />
<p><strong>Working example (continued) </strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="two-arm-non-inferiority-setting.html#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.999</span>,<span class="fl">0.001</span>)</span>
<span id="cb9-2"><a href="two-arm-non-inferiority-setting.html#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="two-arm-non-inferiority-setting.html#cb9-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">6.6</span></span>
<span id="cb9-4"><a href="two-arm-non-inferiority-setting.html#cb9-4" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-5"><a href="two-arm-non-inferiority-setting.html#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="two-arm-non-inferiority-setting.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Rufibach 2016: formula (4)</span></span>
<span id="cb9-7"><a href="two-arm-non-inferiority-setting.html#cb9-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">dnorm</span>(<span class="sc">-</span><span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">-</span><span class="fu">sqrt</span>(m)<span class="sc">/</span>sd_tilde<span class="sc">*</span>(prior_mean<span class="sc">-</span>delta_star)<span class="sc">-</span><span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">qnorm</span>(x))<span class="sc">*</span>(<span class="fu">dnorm</span>(<span class="fu">qnorm</span>(x)))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-8"><a href="two-arm-non-inferiority-setting.html#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="two-arm-non-inferiority-setting.html#cb9-9" aria-hidden="true" tabindex="-1"></a>data_power <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y, <span class="at">type=</span><span class="st">&quot;Enthusiastic&quot;</span>)</span>
<span id="cb9-10"><a href="two-arm-non-inferiority-setting.html#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="two-arm-non-inferiority-setting.html#cb9-11" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">6.6</span></span>
<span id="cb9-12"><a href="two-arm-non-inferiority-setting.html#cb9-12" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> delta_star</span>
<span id="cb9-13"><a href="two-arm-non-inferiority-setting.html#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="two-arm-non-inferiority-setting.html#cb9-14" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">dnorm</span>(<span class="sc">-</span><span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">-</span><span class="fu">sqrt</span>(m)<span class="sc">/</span>sd_tilde<span class="sc">*</span>(prior_mean<span class="sc">-</span>delta_star)<span class="sc">-</span><span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">qnorm</span>(x))<span class="sc">*</span>(<span class="fu">dnorm</span>(<span class="fu">qnorm</span>(x)))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-15"><a href="two-arm-non-inferiority-setting.html#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="two-arm-non-inferiority-setting.html#cb9-16" aria-hidden="true" tabindex="-1"></a>data_power <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_power, <span class="fu">data.frame</span>(x, y, <span class="at">type=</span><span class="st">&quot;Skeptical&quot;</span>))</span>
<span id="cb9-17"><a href="two-arm-non-inferiority-setting.html#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="two-arm-non-inferiority-setting.html#cb9-18" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb9-19"><a href="two-arm-non-inferiority-setting.html#cb9-19" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-20"><a href="two-arm-non-inferiority-setting.html#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="two-arm-non-inferiority-setting.html#cb9-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">dnorm</span>(<span class="sc">-</span><span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">-</span><span class="fu">sqrt</span>(m)<span class="sc">/</span>sd_tilde<span class="sc">*</span>(prior_mean<span class="sc">-</span>delta_star)<span class="sc">-</span><span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">qnorm</span>(x))<span class="sc">*</span>(<span class="fu">dnorm</span>(<span class="fu">qnorm</span>(x)))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-22"><a href="two-arm-non-inferiority-setting.html#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="two-arm-non-inferiority-setting.html#cb9-23" aria-hidden="true" tabindex="-1"></a>data_power <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_power, <span class="fu">data.frame</span>(x, y, <span class="at">type=</span><span class="st">&quot;Informative&quot;</span>))</span>
<span id="cb9-24"><a href="two-arm-non-inferiority-setting.html#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="two-arm-non-inferiority-setting.html#cb9-25" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb9-26"><a href="two-arm-non-inferiority-setting.html#cb9-26" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-27"><a href="two-arm-non-inferiority-setting.html#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="two-arm-non-inferiority-setting.html#cb9-28" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">dnorm</span>(<span class="sc">-</span><span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">-</span><span class="fu">sqrt</span>(m)<span class="sc">/</span>sd_tilde<span class="sc">*</span>(prior_mean<span class="sc">-</span>delta_star)<span class="sc">-</span><span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1<span class="sc">+</span>sd_0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_0)<span class="sc">/</span>(<span class="fu">sqrt</span>(sd_tilde<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m))<span class="sc">*</span><span class="fu">qnorm</span>(x))<span class="sc">*</span>(<span class="fu">dnorm</span>(<span class="fu">qnorm</span>(x)))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-29"><a href="two-arm-non-inferiority-setting.html#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="two-arm-non-inferiority-setting.html#cb9-30" aria-hidden="true" tabindex="-1"></a>data_power <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_power, <span class="fu">data.frame</span>(x, y, <span class="at">type=</span><span class="st">&quot;Noninformative&quot;</span>))</span>
<span id="cb9-31"><a href="two-arm-non-inferiority-setting.html#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="two-arm-non-inferiority-setting.html#cb9-32" aria-hidden="true" tabindex="-1"></a>data_output2 <span class="ot">&lt;-</span> data_output <span class="sc">%&gt;%</span> <span class="fu">select</span>(type, <span class="at">x=</span>AP) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y=</span><span class="dv">0</span>)</span>
<span id="cb9-33"><a href="two-arm-non-inferiority-setting.html#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="two-arm-non-inferiority-setting.html#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_power, <span class="fu">aes</span>(x, y, <span class="at">colour=</span>type))<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">geom_point</span>(<span class="at">data=</span>data_output2, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">colour=</span>type))<span class="sc">+</span><span class="fu">scale_colour_manual</span>(<span class="st">&quot;Prior type&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkred&quot;</span>))<span class="sc">+</span><span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;RPR&quot;</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<hr />

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Kunzmann2022" class="csl-entry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Kunzmann K, Grayling MJ, Lee KM, Robertson DS, Rufibach K, Wason JMS. A review of bayesian perspectives on sample size derivation for confirmatory trials. The American Statistician. 2021;75: 424–432. doi:<a href="https://doi.org/10.1080/00031305.2021.1901782">10.1080/00031305.2021.1901782</a></div>
</div>
<div id="ref-Spiegelhalter2003" class="csl-entry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Spiegelhalter DJ, Abrams KR, Myles JP. Bayesian approaches to clinical trials and health‐care evaluation. Wiley; 2003. doi:<a href="https://doi.org/10.1002/0470092602">10.1002/0470092602</a></div>
</div>
<div id="ref-Baumgartner2020" class="csl-entry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Baumgartner C, Klok FA, Carrier M, Limacher A, Moor J, Righini M, et al. Clinical surveillance vs. Anticoagulation for low-risk patiEnts with isolated SubSegmental pulmonary embolism: Protocol for a multicentre randomised placebo-controlled non-inferiority trial (SAFE-SSPE). BMJ Open. 2020;10: e040151. doi:<a href="https://doi.org/10.1136/bmjopen-2020-040151">10.1136/bmjopen-2020-040151</a></div>
</div>
<div id="ref-Grieve2022" class="csl-entry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Grieve AP. Hybrid frequentist/bayesian power and bayesian power in planning clinical trials. Chapman; Hall/CRC; 2022. doi:<a href="https://doi.org/10.1201/9781003218531">10.1201/9781003218531</a></div>
</div>
<div id="ref-OHagan2005" class="csl-entry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">O’Hagan A, Stevens JW, Campbell MJ. Assurance in clinical trial design. Pharmaceutical Statistics. 2005;4: 187–201. doi:<a href="https://doi.org/10.1002/pst.175">10.1002/pst.175</a></div>
</div>
<div id="ref-Rufibach2016" class="csl-entry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Rufibach K, Burger HU, Abt M. Bayesian predictive power: Choice of prior and some recommendations for its use as probability of success in drug development. Pharmaceutical Statistics. 2016;15: 438–446. doi:<a href="https://doi.org/10.1002/pst.1764">10.1002/pst.1764</a></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
